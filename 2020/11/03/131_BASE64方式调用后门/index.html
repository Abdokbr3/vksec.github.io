<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
U2FsdGVkX19ZlSJYoKaoEeIJo5WD86dYBwXKVGMJec/BwQ5uXVrnniRxNwR0lV87xcTCYyfn7qj0TQt0W4hyjq22lQDJ68qNjisQ4ZVuMiZuqxYbqezJFdVddguY6ZkD/5yBu9W26vPWDq2Ic9dKl+FJqzKYnw7eBlwOkbl1TWhmDjz7RIvkK3IHtRn9evvF3kLLiXK2xVUd0XVIQxSIfAQcTsesRaEvhYPSEyH/uROUlBHNCyYZLEfFP7qfxtcWLUxpICcsJxEr3/wXn/VX5Faecs61QrBZg7OZ+lgN1Q3U7j3ueBuFHll2alPbbPE+mtaLuBgyZo4r6NE28jfnFryQeFvJAtn0F4yKb77Qqkp/Okl/owF/iG4mGU/JVs30mcw2KpFttNang6S8Apv1mp7/boLEn1a5p1MWtgx/lgrZ72CJqSEMOIQFd16T1l6uBb5HdLMT6gUslEMQthZV7ciPFfr/Yl7yONUmsTzr2J3MKIFg7bds4M9A0/PQMxZLY/+JdPsfzRpKw+EGTJJBQkeoidH9jv2pQM2ooxCR8VDuh9cvj0b5L7PFUjvvt50i7OF6ylu0QyVXGQOh82thCzGeswKzDaaPP+B2+vkbp5U7Mn6e1lMRtFXZcM+XdpYhdlCwXO+Izt68BJK3xZ6E6vQ58DIwMr6IPWj8UFVSaHgzE1/vz0SxCJ83HoPu0u9u4Oj3CEaZ44y4Q2caDnnUbEj2nBFnM3pUAq0f7PYf+TC1Sgp56Jnkl4cCtpQHKGXl1LMvVmZTHE+DpBBMXUONV/5q9n8YYx7pIXVoLRUX24erE7RiojKidiw1+nJagyXnK5MiKF/HP2tdbTl23D7/8gpOsj3kLK8X4WzrmirHY1nyArjoN+j+QmkKitJp8LAbaKA+PkOdsCEGryYvc3KQo7CDx7LJFTfBQYq0qx03Wj7WIE24yfqFhbhYbYAtQdcz9i1XQQj0/A0UA+wBhgFU79ep+nQwwdtth0mqxm2sgWhNgs1nCTJ0LGZQWtD5rdWVv5e+8fDlqIvcMST8anMPsk9503sp03wGAq9re0ySPFS486pGcnURpHrYQe9nA5+Lo12FVEtxJMvTnaTJGoTI0SxwVRudyFIEKmtCBhHUy+5gcJdDYnaWXdW02excbX2XzpOS22eU2pQqAW6hmVysJg7/LwQII+utVfx3KJNs0k9eYVYLEUcnIEfpNf8lMfGeIYljy12wRi1jcArEwPSi5owyq4dAxzgNhQYGJxPdePMEAA/QNVcj0QfUiw3hEaFGWJEJ7qAUwwt7UrVwmp6wd7qCFjO72ewelyHfgUSulAfYmv4LrEyfGxt5F3WvilJ6VehPiyTcy2+mdB3K7UCtDnMdTKwjGsDQgSrXhiLEyQZYc7pa87pRKRsgY7jv8+i4rB3bdZLVbF2hYsk7PJJiw43qocjQHEacwDQ1TxfiuJl7VvIY1dG2nhkyr8Gbc6lNGB+tpF1LE70CgVTb9QS1qW3cJq6MO+5f1r0teyJYwovL+/pMoKhZT8HWXEfjvhUhv3EYWGPzcnyKgsBpfZPos+uwZ4SJODfgQv79a3XMbuM0Zu2UmXyx0Qs8uHzUSjw5ZAEcNFSUlXZe+vcWhNDh642PzlWhILA9WSGPBadN30qdeQJRNnDUKaTmmHmWBaBFXkuNvcCKwgtR/MkRbHFqRIJ9TtDhtxmjIIWSkfTGFuKDC1XnhNpnyHquj8DvSY3LCgyoBFAYDncv8hk6fZ5lq++moD2HqtBPrYVmC/9tMjWFk9eXgYJAPmL/q/p9un3rzMnK6y+dNu4SfxiyR8hjDjK2t4+XhNSvmtcfCuAx8f5bVu3Ep1v6CXVX4CHqDuDPDJzpr2ZcPYBUHRJYzZXTUwodZKsm0/fKDOtipoG6H0e4yuhV85SAfFueHBTh3gOcHfUf2lpVLOAImkUEzt0tPXEH5GbINOtzozloyIbxTRZ7LC8pxJAVmIZHO1LiHBW8a7h81Mm/NokI5giaB6arSGGNsE/q/hwD9FjvYO1NSqqRLXzau+yktrF1ZCNNcwP5H+KKWYBOnal5JDRznUfpSaCpy5FV/dAFiq4EqRge1cflJwF8IGcags7drgHDVmsACECyhG7mp6+KXV+tcJ7KSm+F5dGmV/sIErrujJTgevgDUnlmjvVoj1TraAk+gx2oDop2YinzovAZ4iFae5yDaA7pVt+6era5gWL9pYm9ERFRe802JVCVSr/MvMe9mIcGX0txWybW0TJKN5LhRHc3ReEyD6F/9hAGSofyOzM/Mxp8t6nYc4thrJHmtFGDoszYyB3s0MpIDwekcSj0FhCK1XODLGaeaokaCZIETmjR1BZwx9kcNOyEnexKDwBSvvKmiBVIu0WJW5w9/84K+NC6TXhZrXOufJfs+bYa7EHs63N19f2k3Q/06S7RWaEIoCfUIjg6iVCD285z+RVCJFG+kPH3lMon31qLjTRIY7jSqRDjZkFz/XYf+9uelwHJAIlhY84zlYBPiLc/qL+LU451oU0wJxKURleNdn/D1Tx4hsiw7wOekpZat8I+FLCwZpCuBGMLpSRpYAuhLbxzqV9Uvht6XJE8aD+XNV0pAguZ4PrdoQkyD6IUGDGL/UPtNeLV+rcMg9niczzn33YWKosKtyPZI9HAE/1WSxXFsXuuxMaQ0DTRMbnzPpjMpAoPRcCDXC9GSUqzHMbldcQx/3kFuZcm1Ma93yaJFXd48ME47JgRjzMu1qThEwy/hAhh9QMNwMamOwchX0zysWCBXsue+03WKvNdNFjT08haqAbo1wvfuNEu0GpqheFs35NlGfNIKRQKs/eHh78ryD9YXhg/jbCuOXwoUl3YhTQf8IB8xmv8A9SqYY1b9vdk6L7gh60QpZ4y+/27M+/dDrakt/mARwXP3dA1Kyd/WZUBt0G+P+Qu1hB8sT7xFZXS0o/Ey1Z8DcOIrjynywma2EoXtfIw72eqIM707vOpkDAPU/fsRF53U4TWvZzWvgWFDWI8ODBl1WSElTLna5MAgAQxyby6dTzKGhBlNTEmzLA71huQ55ny3lxALfE/Fko1NErjQ4B+mXVcEAB4AhmSEMOL86gWR+H/FFiVT1WMahx/NGBu438qdBYzOMaiBUkV1n8JtPjMyPHpjdHstyuhJVJGjr4IqvMak5or7KqJ7t6DsJBQm51mKeNfANl4OwQqFwfi1BOWDApIYWlpThZJI2uxN32ytVGwTcrUOb0s+4qbEsyRtEltMiP+Tx0jytgw6D6qSv/uuGs6MJ1TpRp9V7uXiKraYB64zgvIb2dbE75st4B53v/Y9jkmdUHUAuSzXoCMxh0GHJGCfM30c09783VP3MbCmDEdx8BaP1T7Y81vZpn69kZl2yCXD+SM8lDtTFzX9Pv0qyheKnL3j4lVFMfwUb6VmnoypSsHrYuOgKZ95zXwHjUKWcaBIm+KB6GiVdC3o6njAx8QdHI/Jdo2KOaqAbBPqSAxqIlz/34hFrg4eZCmcQcrjFnqTaVI/TFi5f+tk5rIHWuy3HYIc9gk4ISeIKvWSmq3NRmI92JahhSndL6bb1Mvqfv3apP7R3Ge/h+NLfxS7mD0S985DSpKWMoY1injypgnE8GLSThWKMxMU9/ArAMiSl+PQPnzqo1jNyx1IYjaLVCU4M+AsgSX99Y4e/NuCTme5FrHZKpRm8z2nDQuN6baUv09klXk2RBboUKd2LDzzXuh7LcBs7P56YqfdbWt4gFCKX99vo7ZFREUYshC2/C/2WVzZD3y/o12xdQF80frRVBtR4Mw21zrx5RYEve45QspODouBhWIlRmncEatd2qUWIb67Tj3cdGR7WQ0DjrFLAxw5J5DVt+ecPnXOcssN/OCDOLuK47oM7jk3dVGiX3OTMCwZkB03hoNfj+ogr1FUQJVymsIQaL+bawETFPBqki0p80FQeVJDbslCd5RyY38IhF6V6bxHwWPcFZcOqvhIl7VgjU0at1Teu/71yUGcuc6Whg1MfDoUShTiKXW7fNfQxZ4VoEA0EXdMJ3XQPIPJfIGulO4/NyiBFxfaSkPlKizcdpYqIzLvPFqLaEi6kjjQALFM/sdy4nXiPj00s/XYIXcmo5gbjZJn1APX7NsY/aHKdFCEI0J7nK2uYhBTWIhzW1XGp4Cn64oIym+2QETFFAnhJ4tWbrQSRCis9wG3jL7AWOCSfEKf69vT4v7eqGNcjlWAOSyOdV6abyMQftAj9Y6Chnl2dspfVrMOfMooYkXisXDaMCLbIbndg/TEQ7FBEwH0GPkc0J7UTBDktZbJDEfSz9ud18bLdWtxKj9T4GX92tFoA/v5UxSTqt3vxo75nrrEmgxguNAu2Fb3z2QNrnXtz4NuvDrWJiZiuOzNBJ6LdcVG6VpnX/LLncDP8aj3shOwM9zOe7nuAsx3+sQc+sXm9P6x8z2LvUcVsfoNpW+C17czqtoKFqXV5+skQzXHrzfuph5ubkKkh+c1XvLCZfhd0cUp5Wu1KDknXjbI3ThN5sjM0rNLMSxHmxEzo8pd7CSJIMGs+J/jWw8qJVw+1DFhXEAW4PB9JXLzKAslchEIvVgOoVFysvny6sijrtZ8z0x78IRC3kf7mqUXc9nZNaBCUxlWVGOjSElLz7T4xaXzov2bkPLBfZBoRdwO/yy6U/PdDmTR7mOSgi+xjX+e1VLJjQnCC9ZQZeRFlQTlLxnPxzflbk7qeMkMFIhfW5eU1qPvnBqF4aq2eMVqVdJ6JuXb9E6YNNbzcAWGY9CpHZMPLoEstzRM9cU5ohIQXWj1/rMu/cNW/4TNKjdUeuuFYJZzKni/nsQyEZPpRqBHeqx0fFR629k2zRaj2PDb012iln5+xhcyMQ0Z6esjULuTXVu6NpwKtuFujkwyL+rx/MptfSEvjHBw1xksH557ZtjqqK/43ZEGFmohxInqDrIT/lUem4bD52Nrdb4SPAxRXOyZ3V2M5Gh8nzQhBxyy3+A6JicBLX6f1pLnDGqH7ylBJrjREXBk/4Q3AqqysFQU0CeW0FFCG9++3DGI6m7VEVNtcdypznMMC6/wLPruDtPs3xG8xhkYpQq/GRYNYmnFvSWV+xRLSWqc7xSCcBnwDSxeVClLDmvUROiT7LzA+FvvKcncKOCgQBMaOBwYe4LbxaLog/PFl+4tJOcojuslFyW+UqUPEuFex1nziEP+1ULvzH9ZIkAxlDBjsA/vn12VUoiHfvYA0vHo6r7qDl57yttsXrc/2BfBwYVDS3PmC2zJAAvnROx+Jt+AAVxmD9RVeb8zCCo1KDD1yZ/37j3+KRF2KFi3RuALOZDkGiaIo8BGQ3Rn8PVScM+9p+TmPvGZfOWr0UW61BCaU9pvUkiOIBg2wikGHdL/0IyE1/Ftm7272ElctjPSNq0MZJMiICvlyFUmLfEFDi+43ZOjLetwgbFke7+PqnqLl34Z4dLtU2c9Aw9k0RvZduwx/aJuw3f0xC0RC2SHYYdvPNU9KgurVOjCOsLF5HIP2maeaRiI6ujjWUBGZU6EGJbpfEGAgxlluDK7WvDrgwYmkvE0QlhNdDPsWSfd/cUj7VrhjjWhgVaGherjqT2dThMRBkoUfliTO1kw9N36Tm/oJNRmCJ4Qqw6q2pkc02FXPLrpx5rTnw+0grM8B7W3ZJuRDMR59AY9jh6rMTJzAhFEs0k+QGMiA76RJOQIjS0B9cSonrlixZE6rMoYz71TJJmJyyddnctN3EcNIkE7YzRYBvr40PmDUaOhHlQ6CH6T7oCnBgbzZBmzlWrLAIAt5DQrkunxfpx2ovdlzIbMyPTNFoxqEo4J/eixVWDX/oY1uj7IyDEzcerNsPAOfnSK4p2l0Xn4T9XDvjj84isUAu3yiyreP1DQSEvkSX/+bF3tuo0U9hxv5k91vvM8X+baTi+/Y03mnT0jRyK9zUQ18lf7ZBdsD0dKaHcbJPyP6qFTBx6B2S1ZSZHZ3cAxesoMceIyHB78KXuKL9Utqq3sSxtS90dR27F8+TEi8sWVv3i9lkPSpmRsRURF+Tlc9fyY0mEHz8qHQzyXOpo54thO4lCelRwUox9tFu/D3lD6Pv1OWTIxIjEBH1gDxxjZe5d78T7hCVOo57EgKoMBS4lOzu3gJ7409UFUpXPfyQWIiPe0sGGGtp3VDRfV7unSahwcuacEacjXm3Xevh4Ut7+LjLqKV+mhtNxFcUMn5DhpArJ+o2j40jDgD38ak86HR58a98uHchvhClSuCaCqhZ24IgaWBX2x6l/TVpagvmaayesHxik74oVLpy2us8sDB47z4Iz1gTsn8+5b39Oz3qCtKAbI9HSXJUxELHO0BXugkFoTUE/X2JVfYJQis0PjGdHao6I/lJEEYerJhDGoZlGvT5uVBj8T7NgKRzAEElGriSbt8d1QZWbs6j6TaOODHG4qAJZlW/h4WvhfFyEnZf6S0HM3xmbL6CEEKle0S5OWJbxpzvUh6F9azqpgnw3k486XPh5eqfRCSpK4KlvFLwe3Q8kj2WZ5ebq6Keh5vCcbwXxpj/jc3MypgFdFwuyYyCcdDIfgcqXBcnCM3BnCoLEe5gcFrDK8OHBpvSM8MJf5PXQnPrexd1Bh+alVu9kD5/gguSVI1oootNIXCJnN3pIs4xSZ4ptpJOgBCrAUOEiXIy35bSHUfoxlR/av4+Li9m6iBmYYJjtZKJB0k5JTcuMHmUBx9h7/NIa8VskHeOKazbvGs9EHosbhkyNBr5aCStmf1g/XLtqKiOAE0vwghHJ58eCZpoIIM18oUYpy3WxG8mawR7lDr340akHwzPigUcJ50sPy3fN8JUVCzZlXC9pgtd1R0GSr2fGWnSWaQlu4KjmkWgzrC3XhWMlEl4qJSPWOrUMcEpFSvb7w31iBZL3NdMZhO00GeyfZvi0Wap9DaxEyryl8EqFv99OE3U0po8OozVTvgOA03BcGAZdTGJtcrMTpJFcZAcGb3op8GgA1lh2vlLXyINWBSO3U5JPB1JnxclI/vvBcGi59C+RWAdFH/sgw6eKEWJ7bSER8xIPZf7ANfq/B6Fk63GzkSC4hEzDwTAbbaocU8YnuWH17YsE02WWI+rbR4T6uicKBvEz0sea+XT7KqnpJd3xDb1NTrrJ/oZLU7wHE5+oi1wfyV5aolP+kHkzvYZpUetdZ+rIzBLjZ4iMiaSt+eqcz0S3y2mCiaOkMAvLBlPJznKKATQyQ9PawuMVYE8DHu/KLUL829jHxeq/at2A8ZnTyyMBWld1YsUxBdXAI0b52xeN97cXcRSyyVJ1U3o3xyZ+qdxl+a9zVqm49xUdmIDZAwA2SCzYI1ZZVacBwQuVxhdRhtk9jy84Glx0UZVmsTM2ZiOPM/0RUdFNVN0dS+/DdARan4Ag4s2tguWgf5yAGHRzyOn+8cdQ2pPvku0BZBskXFTPS3CWai0ihlaQil2YQ0GwiLCujerR+o9K4Zj0oDBYuBzetFPAyOO+ip4E/5h0VwllFYUJAn6DI8Bo4db8r4MJ6bX1wivFxkxHWLwXfFVLmAGoTjBMRQ53RsYf9XHdIqfFpHM8iR4wLbhiPGJ5Ucq0sD4xg/UJDRsxm6dTmcIeOSfaREXuUg137TeJOdReE958RrvFKFvgrutamheaaCe162u3uLUitPJOSgItATryj/aVYoCnMBNqZbxPqrTkhrU3MNCMlwF09IG4tRXOyKCP6wsLj8WrMJUbRY4saP8BCLPo/UakuDeuM2JO/IKiv8611/2v5xgfSX9pC725SLzyFniOqFBdmT2bCiEyTe5UxCHV31V6esyJkz8QntdL8TQQYtS2gQBeb1FnnKgzYEwOCO+m9X2xPpjDO2vPCFILoZw9uLn8xrz+x5U2U+gY/a8TYjnPoEhf9yt1cPmrgZl8RWNNnZ1N4TJrfYbde/tw+sL3Ux5Gf9BFKoCYRpZx5TYxLB71HHO6JsbCw6wuJ+AWWVq0q9iOF+CguePz2yk0z9Wn2AXvKKnzLgqfEG3QHlLgyiyAmYzdtw+N3Xj8tDT27v/JmAYWXJ0FCgg8WpVgC4IwRhXQrnJxyrzAcPCMtF+IQq4Hvaq9Fwpr5vxNhgTd4G5Nkchunp+Sy0PZqYnw20AY0u6M29QaCfRq+AL07OFOqy9HBBj4+UAHJaHLfQ0k2HSqWCTllqaRp0VvNJVp5dBpY7sL17ry9nWAa9eDBuOH3GaBnt7BTBxvrMgDMc2iGFV9PUtR9+aha7sOKVIvnAiaGeakYoPWEAvHgzkaYDdS+afz6sw6iQhMaM5YtVls3l+Au7CEPkObWuCYuUwQjt9Y0uqNbL+FXJgV1h5S9s/KEgx12O1TVHXdu1Z74Ek7nGuGDNoNoyQAlUjvBcYhsXPe1gXcTfnF4EUVwfeZsinFGyXspmdI2k5zCkV5RhD95SHS6qgmM9u3SdizxVViL5jyy/NqnvyeTZ+HIyUGK8w36zSOty1VTpBr8hnb/Pym39ymiY1nJcMZ4xErEKPoncciD0N6DWlN8nBkz4zNpfpCdLxPp1CvNwARoxr4PIC6ipnguQ+q4RJ73hlhYncHk9OMDY4RclpgpQuJRDUuFQBO1h6tLSGbl1swECRbKVQR1YIe3IrxZXDFbf5hsUo5i7KvYuiNcXeLVIkH4hdNl56G0ArJeryYTnSdz8Qwn7GVa6x6KqbD0rYw9H+h4zk556HIPf5IrD1qD2RgFSRSaLRSzUpGjl7bTtUelF9doemwnvhywp8UhqeLCM1q2HbykTLzAqf/XlXMgPd7rdt4MVr/kcXEe07hn4WqrBazmb8KuVOobEKGFRZm8teKuR5K/rMLoy/A2p8vgqMKvR3/abww8X/T7/F6WZT3e9SkfpHVl911MpOi0hsaUKunAa5Z3paRYj6MCjq0bKYXhzXD97eoyYLglvfvs1aQnC9OfemmMxdv9gQvLug+g4IHsXER6ON/PSv1pInQQ7zZJtUAV0obmY8XQZ1i1RXBndALMHac7YDO9S0aWU1vAjJi4xgEw8iXhTf8UOsNe3EatSVJqqy7OBwRFzZh7usiL75/N2x6r2xYup6k9h1giOEbxc1cQpMrEXqiAr636iSFmMVma7Gw1lgmSyieVi/SCdLFg0sz59CpdXDiWmI6faMwEDtq/Yp3G/lw0jVGpP1ZGSdP5g7BoDOKSUilyzKkBNfOC51OedNcUvgT+RXZ0sEqsfD2rwdy5dHPDTM3VLDtS2zAOMifym+6B94osTZZ9SGhYqU8SLCdAdeNxg2JSOermFYEWFcH0IEKKYtOSfc6WbgzJj0BF4xB28rQ3AUMbZOjSGusOpArQ4Cr3rmF2cZRUozoqKEdZFBL0JOzOVWrz14XWyi8AxSFL6qj965GEGBguEOvFIHR7d83THjwgRT/S4C9JedOozorYtfO9IHj+Cgxo1mBlQxClArdM4XAWbAvVHaJFRbLA28o6kUefKpkYgE0EGFy3GUM4bPYzZEMX9QvtRQlG6Q8rCnmkUaZ80xoSTF2eHdmPyEblMNnfy+VETc8q3pxiQffm22HwREG+4MD95+jI/ONMyUqW+tnMDyH62D0x0/tVsdevAiT973oFx7CCpGa2kulXFhfrQEZjOG+mv0gevdmxAHYM8ydxmRnJipQeVZnra83vatDp6VH/sp6nNDme3cz2Mdef167/qTMQ5KHo4mqJV3NH0+vikZfhdfbEUECZNT+nspKqErA8tgFEP1U0vZy7Lo/Xn6hm6qKbtyg3gqluhmTO0V/tjhxbE2zL0b3rMFLb7q8vFcwRiy09MDyPCfg54SItbiRRT6Neu1vX7UXxwXGsF6vjgt77RjvZgn/F+sV457WBZE8CcXX0nEfzsSF6PzjjO8F+UZjJsUCe4ZFw0C9Yx8KNVphU8kW8EQIvnFYmvWYMJX9ThSbj7ZTPHG4VkBtQhG6AjqR2+rQ8PXWSCijnleI4v99B3AvBs5WklwCrT9U0pzUNRuhw7gT+D0nE1Qs01U3gkWjpSklLcm+mWFX2PlSs+z0PkcCD1cBQ9Jp1YTsPRVJBHrTDFjHsIgslyidtFdNscfHl/WQI9QQ1pRldrs8XM85td46byNZ1Wemv4CCkS8HyVxZbJWwB42zhlKiOiN4TaegwPor9RQTYGMYBVtWkLF15CBl8X7AKmSYndOI8frzE6xJ/SRxpzp6+T5yl8MGXNp2gNtXLL7JSAcdM9RjZTsb+aJGRX0W0BNTuO4cbgHjjtOUZvOrHl8dXf8juMbY0LPHswAuK1gaFOGAzMpp5iGHLNpYlkrzgF60wbyIuiZLPoSfE861ODndA0VH+dp6GjKp1+MSJUGLRQbRnQ3c6yJWFZrDmFPNe+ZfqH8aTHS8BrqZFRd+aJ/2KnfbDjexpUljdpyeux+ANEXDV2Fcm8wQTdo/el0OiEXHCUipw/scMfMIoFcr4rdKXOsauH1TimA6YNTkHjBlQdFG495WuoLGSogHEiG+Eyz8at8kRtccZ6cfFQLv/Y+NRUP4bfySUor6M2j5/dW9K2HcVIZVBsOyHOhzf/eGId5nEf8MP8aCH+N3L4NyKZj+S4Vm1Xiq6WsC8elxLXId58np+zhLcTTA81+k0DVUBWH5rv97ST+Xeq25lq5MRwmlBYt5YAUpzRgvAlGRzNHGxU1MDQ0OmueNSrL9K8fpft8f+xTR4l+VPgOWAUPzfjzW31JufrqUygd8Dct+ZOCxSLX/VmJoGAzlqOT0bXnfvlUo8zIq9I4qmRZu71XnnGRCuip/OPCdzTADTXh/usKrD1jvB5mleWIMBwvpzhzvyMlr30LeoVeZdiyY7ayVPEHhKiyOGQhCIFU2CYx8CHtia2kmvSknH5UBCZj5ZsOf1N06BV8ZDjpNJkrAaRi0G5Phqp7HLWsPJqAElPhtNOUdlPgIEdIf+zQGBUrLTbKEEKtSs1+vQ0NYAgxWdSa8ZWCVtpyHkQ+XV2s4399RW7rKqi2Dg/fFRzjM3jXJ4bMexy6wP82rc45OlsUD3gDbntNwPx1xUKqsJC6/GBgeQUfj+wrRKK+iyXSusPer2BUbI2VSt1uzVgzpKkutRbVkTyGWzCpHkLjUyKmxEqGcO+FuUMjSs2GFmjYFOY7isxEIInjQAwY15dqWyJ8zwsKRygDx5+bfrmJeMJ01VUtQj41soT4ihl2uk+1HL96BkEhUpsNxYXRlzWH6Ua45keO5uFSa41vhHXtrV/8vOge4QiTzpeIPNb5r4wyakkbWD96JEoQFeJj5UZ6zQlDHBYCZD8a4Q+Kh6wHQph1//CsvTpm0n63RAuUld/sHNYEUsxxWXydf/VG1Aj7KjMJHLKsNW4co2+pCTnoFqmfhS+lFGdsmTiefwXC6cp1JiWP2fvkBkEUupFdpe+d5IyJ8mFVKJSIymYhMpQPP8Y8GrxOhpizPiM5xrHRBgpfpf38dWOpN9dKN6r6GY+Sdk62DNUiMAhrD2iGFvT7i2pdbVw+ca1KdMEMP2CNcsdmUVtm+l1Nhi041W6TaAP+i3kA9TWde5GYbrb2m3Q3IyQTa5NitguNsIPu8PSvqQeFzlfKL6Qk+BNyljF3SnE2bjpa+T1GguVYrdjwMx6RBdIEYmx7kk8evZXKscboMWk39zeNa0lawX6JKaGr5ApzQsMCzI9dSztOb0Qs/G3+9iAWHfuPNaAD3olID52OmPc41XA82E+FbMenG7dNTMjBFiF8s3hq0iCnymHOpnip2XDHtJ1cvE/hEE8G7OxSaWoAV1DKiieo523ssksyB+pmd923PuaGFo1iPBuyvTJhBzok12LkfDUoGlHTi+GmvlkK47yS49tHgC6P7u10G3wv9H443AlVHpkx3cWGwujn226N+Re92kJYWzLJEGKfOKOKIgZlx8AM1ac7VmJCcwYCRSpqkXw9z5NbL536/S+MqQRNAlHZfwWs/TNpD3hLJizLULy/xhMNvl4kU+GUDfvcwoUhBmciTtFLof3ekTWs6ldFuj64wUMhLVCTu73LfUpq7KgNOuekJ47o1Zez9/OIWCfxbtth9oYf6mFMQ3cV0TBFILPv/LuNxUhQ3u4njSyMK2MGcPXY+BUjmC4QWVQ7wR+X1AZEx/GPDFf3sOE4fobGVMeHRps0FyUcnfAFsKfWsW8hzfF5XynfTVpYu+0p8RqDHkLM+fqjZH4x9yus9iIrmjRkouq85zP3ucZKiY90U9ttd6/WLsfW562R0hUkHknSLtt3GCt92Rq0arK8DGePaS9COwT9pEQQ1zRMilvROzxLiV8ilXc3rKp+W7iotul5OdyZtC9WtbU5InkDvPDcaAXKg/RfpC0sLmAUsTnCWAS4oYMnUtTA/ywcQ9Lc0oa7v+8oqarLer9ZAUmwU+Ihsv1OxdiIoq6zjdF5DOr+y1sdIfrZiYH6WHTRUXqU7fHCUfFneZV3B7VAX0Kca0eBQmy/j2vqtaHz4C3S2scXBUOLWCEQ/UfXGX+w0THhtxsonmCsWIqRC+YJckmvPEYmFS22L9kUdCboc3SzpUGppppK1sIih3sR0S2+Few07h3y/834yhwDlD3qe3leMpVlR7u5ZzZvywbmh7spYRL9GqoK0vvBw30AG6QYEKelJHWQDgjO0YjLHDykxHGov2La7wcDzmQFK8aK4Tq9c9NNfxQ263iaGg4oIH5nEcNgOWPp+fTRDvgWwGSvXENlX7xXJMwWzSYfqlHUnH47l/+aGyU7QyJF1LboXJiDLDlWKAKnwE50qBjeqenBDhQf0jMAU2jQviUijFMaR9S4TmM5VWyg7xavHyi0XDy4nF6qmpiSW32V0zV37j1PHWDmjTxJiqJPRGQxStLR+J+L2hqLU9FV0UNmRhx4qNBwDKHbnR4g3xV2aYuv0FH0BdJXm7kcmPn8wTMMVFs9BlWUzG1E06pvOavMx6Ofab4V2LCj3+gC7eygt8DNuG8EQaHP91ybXYig5+ys+rlypQ1t/pjtxzA6lLANhYcK+7IQiWlC4pwrDwzELorCdI/NSvVtmIrTEbI7rUCgutz/dSa94JPSDlU+gObCPxATiE++NaGbzBzuhD5xrTyHaUbptdB+RveDXjS7un2ymLdJTBBTkX6A2MP//6xd8pHC1reqGoBpfdwRNhZzdOQItbsVPM5WybDFEPDmqd+aYtSCDC5IvFOHTUB5h9jTiqKZSm0TrbvntXpvoSPbWg9j1Z0Stndtq+R885EE5y4jRYQDpeJ3sA2buTd3VI+2YT7WNvNMWnVEG9Zy3BS3VZd8ZmDSADIFKBj72LziSD9mKhGGgAM0BZrqzLHcQ10i2XnE2dkReAi8UUHiP7ZWTpSI2gLnCLtBtALxViX4Uk7YIzU5XtF+EL7C08LO5wJRAXSYEEBNQW2c/lg7mfk5ZAG/3z8LaMoAQGniQgqYVNda1nNswXcyFRd/O95KeHnZl+33jDs2XJu9rROYWNksgJQdOCtcAv5WCGfJ4oYrNDxWXjSfBvQLA0IiSyKaKqcballI81oZWE79FbinUE3NctvyG6tCuc1ufZfhEewYIHTcASF9iHKAaQHnZfi6jnDHYIn5HSTrZ96JGheBaHr5R/Znh042fQw0VVNJwB8f9T5qRUYj9UUXxCIe94Wpc+emi3x7N2/0ljAt7nwKDH6wgPlkND4Y1jFZkltGpn/94lle5ZkIR+/zZf20OGTMnR0Jv/tOF/4zJu2bNr20YH0pZTFdbTP9CJdTfyvR9EUMY1xSdrdeTpbSGCXoOGZ561QEHWbIqU9ynlqWujjqr6JRNQNaV7HPECrthWu+ULZ3TJGGnvAW+hBCUYy7jYazEXQClCrl3VvqIL2DOEO6dFSW5Ld3El5wkU1jbJsFlTtCOgpBtoGFtDUfSSDMKsay693IIp+Ui9XyqUkqf/Vk4rtriFmV7rjOE0Sv0oCo=
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/eGNMc8d.png" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">203</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">72</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
