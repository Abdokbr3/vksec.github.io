<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
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
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/0ivBlsQ.jpg" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">137</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">69</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
