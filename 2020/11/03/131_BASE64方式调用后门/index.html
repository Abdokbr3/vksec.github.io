<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
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
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/0ivBlsQ.jpg" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">164</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">70</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
