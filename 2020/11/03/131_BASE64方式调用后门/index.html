<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
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
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/eGNMc8d.png" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">238</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">72</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
