<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
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
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/0ivBlsQ.jpg" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">176</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">71</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
