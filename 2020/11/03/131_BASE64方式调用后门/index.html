<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
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
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/eGNMc8d.png" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">199</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">72</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
