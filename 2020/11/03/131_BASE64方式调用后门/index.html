<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
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
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/0ivBlsQ.jpg" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">190</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">72</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
