<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="python,网络安全,">





  <link rel="alternate" href="/atom.xml" title="Openresty Python LUA" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="请输入密码,有问题请加QQ群:397745473">
<meta name="keywords" content="python,网络安全">
<meta property="og:type" content="article">
<meta property="og:title" content="BASE64方式调用后门">
<meta property="og:url" content="http://vksec.com/2020/11/03/131_BASE64方式调用后门/index.html">
<meta property="og:site_name" content="Openresty Python LUA">
<meta property="og:description" content="请输入密码,有问题请加QQ群:397745473">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-03T09:38:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BASE64方式调用后门">
<meta name="twitter:description" content="请输入密码,有问题请加QQ群:397745473">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">



  <title>BASE64方式调用后门 | Openresty Python LUA</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Openresty Python LUA</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">QQ群:397745473</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://vksec.com/2020/11/03/131_BASE64方式调用后门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="vsyour">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://i.imgur.com/luMBjvD.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Openresty Python LUA">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                BASE64方式调用后门
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-03T03:03:03+08:00">
                2020-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/11/03/131_BASE64方式调用后门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/11/03/131_BASE64方式调用后门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<div id="hbe-security">
  <div class="hbe-input-container">
  <input type="password" class="hbe-form-control" id="pass" placeholder="请输入密码,有问题请加QQ群:397745473">
    <label for="pass">请输入密码,有问题请加QQ群:397745473</label>
    <div class="bottom-line"></div>
  </div>
</div>
<div id="decryptionError" style="display: none;">Incorrect Password!</div>
<div id="noContentError" style="display: none;">No content to display!</div>
<div id="encrypt-blog" style="display:none">
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
</div>
<script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/网络安全/" rel="tag"># 网络安全</a>
          
           <a href="https://book.xd10086.com/categories/%E9%BB%91%E5%AE%A2/" rel="tag"># 黑客书籍</a>
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/03/129_搭建渗透测试所需VPN/" rel="next" title="快速搭建PCIDSS渗透测试所需VPN">
                <i class="fa fa-chevron-left"></i> 快速搭建PCIDSS渗透测试所需VPN
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/03/130_免费资源整理/" rel="prev" title="免费资源整理">
                免费资源整理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>


    <div class="post-spread">
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<img src="https://i.imgur.com/0ivBlsQ.jpg" alt="知识星球">

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
<script data-ad-client="ca-pub-9873623505122626" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://i.imgur.com/luMBjvD.jpg" alt="vsyour">
          <p class="site-author-name" itemprop="name">vsyour</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">173</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">70</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/vsyour" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/vsyour" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/vsyour" target="_blank" title="FaceBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  FaceBook
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vksec.com/" title="Openresti" target="_blank">Openresti</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.vsyour.com/" title="Blog" target="_blank">Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://vksec.com/2018/01/29/23_vksec_操作记录/" title="操作记录" target="_blank">操作记录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=c3e0580ecf8d705036d1901d44121f3b4e2c3b6a4ad7b417e968784345b01380" title="QQ群" target="_blank">QQ群</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vsyour</span>
</div>


<!-- <div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://vksec.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://vksec.com/2020/11/03/131_BASE64方式调用后门/';
          this.page.identifier = '2020/11/03/131_BASE64方式调用后门/';
          this.page.title = 'BASE64方式调用后门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://vksec.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      $('#local-search-input').focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            var resultItems = [];
            if (this.value.trim().length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCountInArticle = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword, i) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCountInArticle = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  var resultItem = '';

                  function highlightKeyword(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;

                    var matchText = text.substring(start, end);
                    var matchResult = [];
                    var prevEnd = 0;
                    while (position + word.length <= end && index.length != 0) {

                      // highlight keyword

                      var wordBegin = position - start;
                      var wordEnd = position - start + word.length;
                      matchResult.push(matchText.substring(prevEnd, wordBegin));
                      matchResult.push("<b class=\"search-keyword\">" + matchText.substring(wordBegin, wordEnd) + "</b>");

                      // move to next position of hit

                      index.pop();
                      prevEnd = wordEnd;
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (prevEnd > position - start) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    matchResult.push(matchText.substring(prevEnd));
                    return matchResult.join('');
                  }

                  // sort index by position of keyword

                  indexOfTitle.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  indexOfContent.sort(function (itemLeft, itemRight) {
                    return itemRight.position - itemLeft.position;
                  });

                  // highlight title

                  if (indexOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, 0, title.length, indexOfTitle) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  // highlight content

                  var resultUpperBound = parseInt(1);
                  var withoutUpperBound = false;
                  if (resultUpperBound === -1) {
                    withoutUpperBound = true;
                  }
                  var currentResultNum = 0;
                  while (indexOfContent.length != 0 && (withoutUpperBound || (currentResultNum < resultUpperBound))) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    resultItem += "<a href='" + articleUrl + "'>" +
                    "<p class=\"search-result\">" + highlightKeyword(content, start, end, indexOfContent) +
                    "...</p>" + "</a>";
                    currentResultNum++;
                  }
                  resultItem += "</li>";
                  resultItems.push({item: resultItem, hitCount: hitCountInArticle, id: resultItems.length});
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              $resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.hitCount != resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultLeft.id - resultRight.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result, i) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              $resultContent.innerHTML = searchResultList;
            }
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

  

</body>
</html>
